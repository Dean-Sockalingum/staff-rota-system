/**
 * Mobile Responsiveness Enhancements
 * Staff Rota System - December 2025
 * 
 * Optimized for:
 * - Phones (320px - 767px)
 * - Tablets (768px - 1024px)
 * - Desktop (1025px+)
 */

/* ==============================================
   TOUCH-FRIENDLY BUTTONS & LINKS - WCAG 2.5.5 AAA
   ============================================== */

/* Minimum touch target size: 44x44px (WCAG 2.5.5 Level AAA) */
@media (max-width: 768px) {
    /* All interactive elements */
    .btn, 
    .nav-link, 
    .dropdown-item,
    button,
    a.btn,
    input[type="submit"],
    input[type="button"],
    input[type="reset"] {
        min-height: var(--touch-target-min, 44px);
        min-width: var(--touch-target-min, 44px);
        padding: 12px 16px;
        font-size: 16px; /* Prevent zoom on iOS */
        line-height: 1.5;
    }

    /* Small buttons - still meet minimum */
    .btn-sm {
        min-height: var(--touch-target-min, 44px);
        min-width: var(--touch-target-min, 44px);
        padding: 10px 14px;
        font-size: 15px;
    }

    /* Large buttons - extra comfortable */
    .btn-lg {
        min-height: var(--touch-target-comfortable, 48px);
        min-width: var(--touch-target-comfortable, 48px);
        padding: 14px 20px;
        font-size: 18px;
    }
    
    /* Primary action buttons - most spacious */
    .btn-primary,
    .btn-success {
        min-height: var(--touch-target-comfortable, 48px);
        padding: 14px 24px;
    }

    /* Icon-only buttons need extra padding */
    .btn-icon-only,
    .btn[aria-label]:not(:has(span)),
    button:not(:has(*)) {
        min-width: var(--touch-target-min, 44px);
        min-height: var(--touch-target-min, 44px);
        padding: 12px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    /* Increase spacing between buttons */
    .btn + .btn {
        margin-left: var(--touch-spacing-comfortable, 12px);
        margin-top: var(--touch-spacing-comfortable, 12px);
    }

    .btn-group .btn {
        margin-left: 0;
        margin-top: 0;
    }
    
    /* Navigation links */
    .navbar-nav .nav-link {
        min-height: var(--touch-target-min, 44px);
        padding: 12px 16px;
        display: flex;
        align-items: center;
    }
    
    /* Dropdown items */
    .dropdown-item {
        min-height: var(--touch-target-min, 44px);
        padding: 12px 20px;
        display: flex;
        align-items: center;
    }
    
    /* Form inputs */
    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="number"],
    input[type="tel"],
    input[type="url"],
    input[type="search"],
    input[type="date"],
    input[type="time"],
    input[type="datetime-local"],
    select,
    textarea {
        min-height: var(--touch-target-min, 44px);
        padding: 12px 16px;
        font-size: 16px; /* Prevent iOS zoom */
    }
    
    /* Checkboxes and radio buttons */
    input[type="checkbox"],
    input[type="radio"] {
        min-width: 24px;
        min-height: 24px;
        /* Add padding around for larger tap area */
        margin: 10px;
    }
    
    /* Labels for checkboxes/radios - increase tap area */
    .form-check-label,
    label:has(input[type="checkbox"]),
    label:has(input[type="radio"]) {
        min-height: var(--touch-target-min, 44px);
        display: flex;
        align-items: center;
        padding: 10px 0;
        cursor: pointer;
    }
    
    /* Links in content */
    a:not(.btn):not(.nav-link):not(.dropdown-item) {
        padding: 4px 2px;
        margin: -4px -2px;
        display: inline-block;
    }
    
    /* Pagination links */
    .pagination .page-link {
        min-width: var(--touch-target-min, 44px);
        min-height: var(--touch-target-min, 44px);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 12px;
    }
    
    /* Table action buttons */
    .table .btn,
    .table button,
    .table a.btn {
        min-height: var(--touch-target-min, 44px);
        min-width: var(--touch-target-min, 44px);
        padding: 8px 12px;
        margin: 2px;
    }
    
    /* Close buttons (X) */
    .btn-close,
    button[aria-label="Close"],
    .close {
        min-width: var(--touch-target-min, 44px);
        min-height: var(--touch-target-min, 44px);
        padding: 12px;
    }
    
    /* Badge buttons/links */
    .badge.clickable,
    a.badge {
        min-height: 32px;
        padding: 8px 12px;
        display: inline-flex;
        align-items: center;
    }
}

/* ==============================================
   RESPONSIVE TABLES
   ============================================== */

/* Hide tables on mobile, show card layout */
@media (max-width: 767px) {
    .table-responsive {
        border: none;
    }

    /* Option 1: Transform table to cards */
    .mobile-card-table {
        display: none !important;
    }

    .mobile-card-view {
        display: block;
    }

    .table-card {
        background: #fff;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 12px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    .table-card .card-row {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid #f0f0f0;
    }

    .table-card .card-row:last-child {
        border-bottom: none;
    }

    .table-card .card-label {
        font-weight: 600;
        color: #666;
        font-size: 14px;
    }

    .table-card .card-value {
        font-size: 14px;
        text-align: right;
    }

    /* Option 2: Horizontal scroll with sticky first column */
    .table-scroll {
        display: block;
        max-width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }

    .table-scroll thead th:first-child,
    .table-scroll tbody td:first-child {
        position: sticky;
        left: 0;
        background: #fff;
        z-index: 2;
        box-shadow: 2px 0 4px rgba(0,0,0,0.05);
    }
}

@media (min-width: 768px) {
    .mobile-card-view {
        display: none;
    }

    .mobile-card-table {
        display: table !important;
    }
}

/* ==============================================
   NAVIGATION IMPROVEMENTS
   ============================================== */

@media (max-width: 991px) {
    /* Hamburger menu styling */
    .navbar-toggler {
        min-width: 48px;
        min-height: 48px;
        padding: 12px;
        font-size: 24px;
    }

    .navbar-collapse {
        background: #0d6efd;
        margin: 12px -16px -8px -16px;
        padding: 12px 16px;
        border-radius: 0 0 8px 8px;
    }

    .navbar-nav .nav-link {
        padding: 14px 16px;
        border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .navbar-nav .nav-link:last-child {
        border-bottom: none;
    }

    /* Dropdown menus full-width on mobile */
    .navbar-nav .dropdown-menu {
        position: static !important;
        transform: none !important;
        width: 100%;
        border: none;
        margin-top: 0;
        box-shadow: none;
    }

    .navbar-nav .dropdown-item {
        padding: 14px 24px;
    }
}

/* ==============================================
   FORM OPTIMIZATIONS
   ============================================== */

@media (max-width: 768px) {
    /* Prevent iOS zoom on input focus */
    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="number"],
    input[type="date"],
    input[type="tel"],
    select,
    textarea {
        font-size: 16px !important;
        min-height: 44px;
        padding: 12px;
    }

    .form-control {
        font-size: 16px !important;
        min-height: 44px;
    }

    .form-select {
        font-size: 16px !important;
        min-height: 44px;
        background-size: 16px 12px;
        padding-right: 36px;
    }

    .form-label {
        font-size: 15px;
        margin-bottom: 6px;
        font-weight: 600;
    }

    /* Stack form groups vertically */
    .row .col-md-6,
    .row .col-md-4,
    .row .col-md-3 {
        margin-bottom: 16px;
    }

    /* Full-width buttons in forms */
    form .btn-primary,
    form .btn-success {
        width: 100%;
        margin-bottom: 8px;
    }

    form .btn-secondary,
    form .btn-outline-secondary {
        width: 100%;
    }
}

/* ==============================================
   DASHBOARD CARDS
   ============================================== */

@media (max-width: 767px) {
    /* Stack cards vertically */
    .row > [class*="col-"] {
        margin-bottom: 16px;
    }

    .card {
        margin-bottom: 16px;
    }

    .card-body {
        padding: 16px;
    }

    .card-header {
        padding: 12px 16px;
        font-size: 16px;
    }

    /* Simplify stat cards */
    .stat-card,
    .widget-card,
    .stats-card {
        min-height: auto;
    }

    .stat-card .count,
    .widget-card .count {
        font-size: 28px !important;
    }

    .stat-card .label,
    .widget-card .label {
        font-size: 13px !important;
    }
}

@media (min-width: 768px) and (max-width: 1024px) {
    /* Tablet: 2 columns */
    .col-md-3 {
        flex: 0 0 50%;
        max-width: 50%;
    }
}

/* ==============================================
   MODAL IMPROVEMENTS
   ============================================== */

@media (max-width: 767px) {
    .modal-dialog {
        margin: 8px;
        max-width: calc(100% - 16px);
    }

    .modal-content {
        border-radius: 12px;
    }

    .modal-header {
        padding: 16px;
    }

    .modal-body {
        padding: 16px;
        max-height: calc(100vh - 200px);
        overflow-y: auto;
    }

    .modal-footer {
        padding: 12px 16px;
        flex-direction: column;
    }

    .modal-footer .btn {
        width: 100%;
        margin: 4px 0;
    }

    .modal-footer .btn + .btn {
        margin-left: 0;
    }

    /* Full-screen modals on mobile */
    .modal-fullscreen-sm-down {
        width: 100%;
        max-width: 100%;
        height: 100%;
        margin: 0;
    }

    .modal-fullscreen-sm-down .modal-content {
        height: 100%;
        border: 0;
        border-radius: 0;
    }
}

/* ==============================================
   CHARTS & GRAPHS
   ============================================== */

@media (max-width: 768px) {
    /* Make charts responsive */
    canvas {
        max-width: 100% !important;
        height: auto !important;
    }

    .chart-container {
        position: relative;
        height: 300px;
        width: 100%;
    }

    /* Reduce chart height on mobile */
    #demandForecast,
    #staffingChart,
    #budgetChart {
        max-height: 250px !important;
    }
}

/* ==============================================
   TYPOGRAPHY SCALING
   ============================================== */

@media (max-width: 767px) {
    h1, .h1 {
        font-size: 24px;
    }

    h2, .h2 {
        font-size: 20px;
    }

    h3, .h3 {
        font-size: 18px;
    }

    h4, .h4 {
        font-size: 16px;
    }

    h5, .h5 {
        font-size: 15px;
    }

    h6, .h6 {
        font-size: 14px;
    }

    p, .text-muted, small {
        font-size: 14px;
        line-height: 1.6;
    }

    /* Increase line spacing for readability */
    body {
        line-height: 1.6;
    }
}

/* ==============================================
   SPACING ADJUSTMENTS
   ============================================== */

@media (max-width: 767px) {
    /* Reduce container padding */
    .container-fluid {
        padding-left: 12px;
        padding-right: 12px;
    }

    .container {
        padding-left: 12px;
        padding-right: 12px;
    }

    /* Reduce margin on main content */
    main.container-fluid {
        margin-top: 12px !important;
    }

    /* Tighter spacing for alerts */
    .alert {
        padding: 12px;
        margin-bottom: 12px;
        font-size: 14px;
    }

    /* Reduce badge sizes */
    .badge {
        font-size: 12px;
        padding: 4px 8px;
    }
}

/* ==============================================
   SCROLLABLE AREAS
   ============================================== */

@media (max-width: 768px) {
    /* Ensure scrollable areas are obvious */
    .table-responsive,
    .overflow-auto {
        -webkit-overflow-scrolling: touch;
        scrollbar-width: thin;
    }

    /* Shadow hints for horizontal scroll */
    .table-responsive::after {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        width: 20px;
        background: linear-gradient(to left, rgba(0,0,0,0.05), transparent);
        pointer-events: none;
    }
}

/* ==============================================
   ROTA / CALENDAR VIEWS
   ============================================== */

@media (max-width: 767px) {
    /* Calendar day cells */
    .calendar-day {
        min-height: 80px;
        padding: 6px;
        font-size: 13px;
    }

    /* Shift cards smaller on mobile */
    .shift-card {
        padding: 6px;
        margin: 2px 0;
        font-size: 12px;
    }

    /* Leave cards */
    .leave-card {
        padding: 4px 6px;
        font-size: 11px;
    }

    /* Hide weekdays on very small screens */
    @media (max-width: 400px) {
        .calendar-day .day-name {
            font-size: 11px;
        }
    }
}

/* ==============================================
   AI ASSISTANT WIDGET
   ============================================== */

@media (max-width: 768px) {
    /* Make AI widget more accessible on mobile */
    #ai-assistant-widget {
        position: fixed;
        bottom: 16px;
        right: 16px;
        z-index: 1050;
    }

    #ai-assistant-button {
        width: 56px;
        height: 56px;
        border-radius: 50%;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    #ai-assistant-panel {
        position: fixed;
        bottom: 80px;
        right: 16px;
        left: 16px;
        max-height: calc(100vh - 120px);
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.2);
    }

    #ai-chat-input {
        font-size: 16px; /* Prevent iOS zoom */
        min-height: 44px;
    }
}

/* ==============================================
   ACCESSIBILITY ENHANCEMENTS
   ============================================== */

@media (max-width: 768px) {
    /* Larger tap targets for icons */
    .fa, .fas, .far, .fal, .fab {
        font-size: 18px;
    }

    /* Icon buttons */
    .btn-icon {
        min-width: 44px;
        min-height: 44px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    /* Focus indicators larger on mobile */
    a:focus,
    button:focus,
    input:focus,
    select:focus,
    textarea:focus {
        outline: 3px solid #0d6efd;
        outline-offset: 2px;
    }

    /* Skip to content link */
    .skip-to-content {
        position: absolute;
        top: -40px;
        left: 0;
        background: #000;
        color: #fff;
        padding: 12px;
        text-decoration: none;
        z-index: 9999;
    }

    .skip-to-content:focus {
        top: 0;
    }
}

/* ==============================================
   LANDSCAPE ORIENTATION HINTS
   ============================================== */

@media (max-width: 767px) and (orientation: landscape) {
    /* Reduce header size in landscape */
    .navbar-brand {
        font-size: 16px;
    }

    .navbar {
        padding: 8px 16px;
    }

    main.container-fluid {
        margin-top: 8px !important;
    }
}

/* ==============================================
   PRINT STYLES (Mobile-friendly)
   ============================================== */

@media print {
    /* Hide navigation and controls */
    .navbar,
    .btn,
    .no-print,
    #ai-assistant-widget {
        display: none !important;
    }

    /* Full-width content */
    .container,
    .container-fluid {
        width: 100%;
        max-width: 100%;
        padding: 0;
    }

    /* Improve table printing */
    .table-responsive {
        overflow: visible;
    }

    .table {
        font-size: 10pt;
    }

    /* Page breaks */
    .card,
    .table {
        page-break-inside: avoid;
    }

    h1, h2, h3, h4, h5, h6 {
        page-break-after: avoid;
    }
}

/* ==============================================
   DEVICE-SPECIFIC FIXES
   ============================================== */

/* iOS Safari specific fixes */
@supports (-webkit-touch-callout: none) {
    @media (max-width: 768px) {
        /* Fix for iOS Safari bottom bar */
        .ios-safe-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* Prevent rubber band effect */
        body {
            overscroll-behavior: none;
        }

        /* Fix sticky positioning in iOS */
        .sticky-top {
            position: -webkit-sticky;
            position: sticky;
        }
    }
}

/* Android Chrome specific */
@media (max-width: 768px) {
    /* Improve tap delay */
    a, button, input, select {
        touch-action: manipulation;
    }
}

/* ==============================================
   TABLET-SPECIFIC OPTIMIZATIONS
   ============================================== */

@media (min-width: 768px) and (max-width: 1024px) {
    /* Optimize for iPad and Android tablets */
    
    /* Comfortable touch targets */
    .btn {
        min-height: 40px;
        padding: 10px 16px;
    }

    /* 2-column layouts */
    .row .col-lg-3 {
        flex: 0 0 50%;
        max-width: 50%;
    }

    /* Larger modals */
    .modal-lg {
        max-width: 90%;
    }

    /* Comfortable table spacing */
    .table td,
    .table th {
        padding: 12px;
    }
}

/* ==============================================
   PROGRESSIVE ENHANCEMENT
   ============================================== */

/* Default: Mobile-first approach */
/* All base styles assume mobile */
/* Larger screens get enhancements via min-width media queries */

/* ==============================================
   UTILITY CLASSES
   ============================================== */

/* Hide on mobile only */
.hide-mobile {
    display: none !important;
}

@media (min-width: 768px) {
    .hide-mobile {
        display: block !important;
    }
}

/* Show on mobile only */
.show-mobile {
    display: block !important;
}

@media (min-width: 768px) {
    .show-mobile {
        display: none !important;
    }
}

/* Hide on tablet */
@media (min-width: 768px) and (max-width: 1024px) {
    .hide-tablet {
        display: none !important;
    }
}

/* Touch-friendly spacing */
.touch-spacing > * + * {
    margin-top: 12px;
}

@media (min-width: 768px) {
    .touch-spacing > * + * {
        margin-top: 8px;
    }
}

/* Responsive text alignment */
.text-mobile-center {
    text-align: center;
}

@media (min-width: 768px) {
    .text-mobile-center {
        text-align: left;
    }
}

/* ==============================================
   PERFORMANCE OPTIMIZATIONS
   ============================================== */

@media (max-width: 768px) {
    /* Reduce animations on mobile for performance */
    *, *::before, *::after {
        animation-duration: 0.3s !important;
        transition-duration: 0.2s !important;
    }

    /* Disable hover effects on touch devices */
    @media (hover: none) {
        .card:hover,
        .btn:hover,
        .table-row:hover {
            transform: none;
            box-shadow: none;
        }
    }
}

/* ==============================================
   END OF MOBILE RESPONSIVE STYLES
   ============================================== */
