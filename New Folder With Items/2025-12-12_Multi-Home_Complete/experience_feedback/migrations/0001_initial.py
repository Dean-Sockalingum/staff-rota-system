# Generated by Django 4.2.27 on 2026-01-14 17:58

from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import django.utils.timezone


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('scheduling', '0058_alter_user_sms_notifications_enabled'),
    ]

    operations = [
        migrations.CreateModel(
            name='SatisfactionSurvey',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('survey_type', models.CharField(choices=[('RESIDENT_ADMISSION', 'Resident - Admission'), ('RESIDENT_ONGOING', 'Resident - Ongoing Care'), ('RESIDENT_DISCHARGE', 'Resident - Discharge'), ('FAMILY_ADMISSION', 'Family - Admission'), ('FAMILY_ONGOING', 'Family - Ongoing Care'), ('FAMILY_BEREAVEMENT', 'Family - Bereavement'), ('STAFF_EXPERIENCE', 'Staff Experience')], help_text='Type of satisfaction survey', max_length=30)),
                ('survey_date', models.DateField(default=django.utils.timezone.now)),
                ('respondent_name', models.CharField(blank=True, help_text='Name of person completing survey (optional for anonymity)', max_length=200)),
                ('relationship_to_resident', models.CharField(blank=True, help_text='e.g., Self, Daughter, Son, Power of Attorney', max_length=100)),
                ('is_anonymous', models.BooleanField(default=False, help_text='Anonymous survey (no identifying information)')),
                ('overall_satisfaction', models.IntegerField(help_text='Overall satisfaction (1=Very Dissatisfied, 5=Very Satisfied)', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('quality_of_care', models.IntegerField(blank=True, help_text='Quality of care provided', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('staff_attitude', models.IntegerField(blank=True, help_text='Staff friendliness and professionalism', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('communication', models.IntegerField(blank=True, help_text='Communication with staff and management', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('environment_cleanliness', models.IntegerField(blank=True, help_text='Cleanliness and maintenance of environment', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('meals_nutrition', models.IntegerField(blank=True, help_text='Quality and variety of meals', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('activities_engagement', models.IntegerField(blank=True, help_text='Activities and social engagement opportunities', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('dignity_respect', models.IntegerField(blank=True, help_text='Dignity and respect shown to residents', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('safety_security', models.IntegerField(blank=True, help_text='Feeling of safety and security', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('likelihood_recommend', models.IntegerField(blank=True, help_text='How likely to recommend? (0=Not at all, 10=Extremely likely)', null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(10)])),
                ('what_works_well', models.TextField(blank=True, help_text='What aspects of care work well?')),
                ('areas_for_improvement', models.TextField(blank=True, help_text='What could be improved?')),
                ('additional_comments', models.TextField(blank=True, help_text='Any other comments or feedback')),
                ('requires_followup', models.BooleanField(default=False, help_text='Does this survey require follow-up action?')),
                ('followup_completed', models.BooleanField(default=False)),
                ('followup_notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('care_home', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='satisfaction_surveys', to='scheduling.carehome')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_surveys', to=settings.AUTH_USER_MODEL)),
                ('followup_assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_survey_followups', to=settings.AUTH_USER_MODEL)),
                ('resident', models.ForeignKey(blank=True, help_text='Resident being surveyed or whose care is being assessed', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='satisfaction_surveys', to='scheduling.resident')),
            ],
            options={
                'verbose_name': 'Satisfaction Survey',
                'verbose_name_plural': 'Satisfaction Surveys',
                'ordering': ['-survey_date', '-created_at'],
                'indexes': [models.Index(fields=['care_home', '-survey_date'], name='experience__care_ho_8bef53_idx'), models.Index(fields=['survey_type', '-survey_date'], name='experience__survey__c83c73_idx'), models.Index(fields=['resident', '-survey_date'], name='experience__residen_c95978_idx'), models.Index(fields=['-survey_date'], name='experience__survey__8389ef_idx')],
            },
        ),
        migrations.CreateModel(
            name='QualityOfLifeAssessment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('assessment_date', models.DateField(default=django.utils.timezone.now)),
                ('assessment_tool', models.CharField(choices=[('DEMQOL', 'DEMQOL (Dementia Quality of Life)'), ('EQ5D', 'EQ-5D-5L (EuroQol)'), ('WHOQOL', 'WHOQOL-BREF'), ('QUALID', 'QUALID (Quality of Life in Dementia)'), ('CUSTOM', 'Custom Care Home Assessment')], default='CUSTOM', max_length=50)),
                ('physical_health', models.IntegerField(help_text='Physical health and mobility', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('psychological_wellbeing', models.IntegerField(help_text='Mood, anxiety, happiness', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('social_relationships', models.IntegerField(help_text='Relationships with others, social engagement', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('independence_autonomy', models.IntegerField(help_text='Ability to make choices and maintain independence', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('environment_comfort', models.IntegerField(help_text='Physical environment and comfort', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('pain_discomfort', models.IntegerField(blank=True, help_text='Level of pain/discomfort (1=Severe, 5=None)', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('cognitive_function', models.IntegerField(blank=True, help_text='Memory and cognitive ability', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('meaningful_activity', models.IntegerField(blank=True, help_text='Engagement in meaningful activities', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('spiritual_needs', models.IntegerField(blank=True, help_text='Spiritual and cultural needs met', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('overall_qol_score', models.DecimalField(blank=True, decimal_places=2, help_text='Overall QoL score (calculated or assessed)', max_digits=4, null=True)),
                ('assessment_method', models.CharField(choices=[('SELF_REPORT', 'Self-Report by Resident'), ('PROXY', 'Proxy (Family/Staff)'), ('OBSERVATION', 'Observation'), ('COMBINED', 'Combined Methods')], default='COMBINED', max_length=20)),
                ('strengths_noted', models.TextField(blank=True, help_text='Areas where QoL is good')),
                ('concerns_noted', models.TextField(blank=True, help_text='Areas of concern or decline')),
                ('interventions_recommended', models.TextField(blank=True, help_text='Recommended interventions to improve QoL')),
                ('requires_review', models.BooleanField(default=False, help_text='Does this assessment require management review?')),
                ('review_completed', models.BooleanField(default=False)),
                ('next_assessment_due', models.DateField(blank=True, help_text='When should the next assessment occur?', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assessed_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='qol_assessments', to=settings.AUTH_USER_MODEL)),
                ('resident', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='qol_assessments', to='scheduling.resident')),
            ],
            options={
                'verbose_name': 'Quality of Life Assessment',
                'verbose_name_plural': 'Quality of Life Assessments',
                'ordering': ['-assessment_date', 'resident'],
                'indexes': [models.Index(fields=['resident', '-assessment_date'], name='experience__residen_e420cf_idx'), models.Index(fields=['-assessment_date'], name='experience__assessm_dd1b25_idx')],
            },
        ),
        migrations.CreateModel(
            name='FeedbackTheme',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('theme_name', models.CharField(help_text='Name of the feedback theme', max_length=200)),
                ('theme_category', models.CharField(choices=[('POSITIVE', 'Positive Feedback'), ('CONCERN', 'Area of Concern'), ('SUGGESTION', 'Improvement Suggestion'), ('COMPLAINT', 'Complaint Theme')], default='CONCERN', max_length=50)),
                ('description', models.TextField(help_text='Description of this theme and examples')),
                ('occurrences_count', models.IntegerField(default=0, help_text='Number of times this theme has appeared in feedback')),
                ('first_identified', models.DateField(default=django.utils.timezone.now)),
                ('last_occurrence', models.DateField(blank=True, null=True)),
                ('trend_direction', models.CharField(blank=True, choices=[('INCREASING', 'Increasing'), ('STABLE', 'Stable'), ('DECREASING', 'Decreasing')], max_length=20, null=True)),
                ('action_plan', models.TextField(blank=True, help_text='Action plan to address this theme')),
                ('actions_taken', models.TextField(blank=True, help_text='Actions that have been taken')),
                ('impact_on_satisfaction', models.IntegerField(blank=True, help_text='Impact on overall satisfaction (1=Low, 5=High)', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('is_active', models.BooleanField(default=True, help_text='Is this theme still being monitored?')),
                ('resolved_date', models.DateField(blank=True, help_text='Date theme was resolved or closed', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_feedback_themes', to=settings.AUTH_USER_MODEL)),
                ('care_home', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='feedback_themes', to='scheduling.carehome')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_feedback_themes', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Feedback Theme',
                'verbose_name_plural': 'Feedback Themes',
                'ordering': ['-occurrences_count', '-last_occurrence'],
                'indexes': [models.Index(fields=['care_home', 'is_active'], name='experience__care_ho_b58bdc_idx'), models.Index(fields=['theme_category', '-occurrences_count'], name='experience__theme_c_5fa890_idx')],
            },
        ),
        migrations.CreateModel(
            name='EBCDTouchpoint',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('touchpoint_name', models.CharField(help_text="Name of this touchpoint (e.g., 'First Morning Wake Up')", max_length=200)),
                ('category', models.CharField(choices=[('ADMISSION', 'Admission & Moving In'), ('DAILY_CARE', 'Daily Care Routines'), ('ACTIVITIES', 'Activities & Social'), ('MEALS', 'Meals & Nutrition'), ('MEDICAL', 'Medical Care & Health'), ('FAMILY_VISIT', 'Family Visits'), ('END_OF_LIFE', 'End of Life Care'), ('ENVIRONMENT', 'Physical Environment')], help_text='Category of care journey', max_length=30)),
                ('description', models.TextField(help_text='Description of what happens at this touchpoint')),
                ('sequence_order', models.IntegerField(default=0, help_text='Order in the resident journey')),
                ('importance_rating', models.IntegerField(help_text='How important is this touchpoint? (1=Low, 5=Critical)', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('emotional_impact', models.CharField(choices=[('VERY_POSITIVE', 'Very Positive'), ('POSITIVE', 'Positive'), ('NEUTRAL', 'Neutral'), ('NEGATIVE', 'Negative'), ('VERY_NEGATIVE', 'Very Negative')], default='NEUTRAL', help_text='Typical emotional impact on residents/families', max_length=20)),
                ('current_experience_rating', models.IntegerField(blank=True, help_text='Current experience quality (1=Poor, 5=Excellent)', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('pain_points', models.TextField(blank=True, help_text='Known problems or challenges at this touchpoint')),
                ('improvement_ideas', models.TextField(blank=True, help_text='Ideas for improving this touchpoint')),
                ('target_experience_rating', models.IntegerField(blank=True, help_text='Target experience quality (1=Poor, 5=Excellent)', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('residents_consulted', models.IntegerField(default=0, help_text='Number of residents consulted about this touchpoint')),
                ('families_consulted', models.IntegerField(default=0, help_text='Number of family members consulted')),
                ('staff_consulted', models.IntegerField(default=0, help_text='Number of staff consulted')),
                ('improvements_implemented', models.TextField(blank=True, help_text='Improvements that have been implemented')),
                ('implementation_date', models.DateField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True, help_text='Is this touchpoint still being monitored?')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('care_home', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ebcd_touchpoints', to='scheduling.carehome')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'EBCD Touchpoint',
                'verbose_name_plural': 'EBCD Touchpoints',
                'ordering': ['care_home', 'category', 'sequence_order'],
                'indexes': [models.Index(fields=['care_home', 'category'], name='experience__care_ho_c08821_idx'), models.Index(fields=['is_active'], name='experience__is_acti_87db66_idx')],
            },
        ),
        migrations.CreateModel(
            name='Complaint',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('complaint_reference', models.CharField(help_text='Unique complaint reference number', max_length=20, unique=True)),
                ('complainant_name', models.CharField(max_length=200)),
                ('complainant_relationship', models.CharField(help_text='Relationship to resident (e.g., Son, Daughter, Resident themselves)', max_length=100)),
                ('complainant_contact', models.CharField(blank=True, help_text='Phone or email for contact', max_length=200)),
                ('date_received', models.DateField(default=django.utils.timezone.now)),
                ('complaint_category', models.CharField(choices=[('CARE_QUALITY', 'Quality of Care'), ('STAFF_CONDUCT', 'Staff Conduct/Attitude'), ('SAFETY', 'Safety Concern'), ('ENVIRONMENT', 'Facilities/Environment'), ('COMMUNICATION', 'Communication'), ('MEALS', 'Meals/Nutrition'), ('ACTIVITIES', 'Activities/Social Life'), ('MEDICATION', 'Medication Management'), ('PERSONAL_CARE', 'Personal Care'), ('DIGNITY', 'Dignity/Respect'), ('FINANCIAL', 'Financial/Fees'), ('OTHER', 'Other')], default='OTHER', max_length=50)),
                ('severity', models.CharField(choices=[('LOW', 'Low - Minor Concern'), ('MEDIUM', 'Medium - Moderate Issue'), ('HIGH', 'High - Serious Matter'), ('CRITICAL', 'Critical - Safeguarding/Safety')], default='MEDIUM', max_length=20)),
                ('complaint_description', models.TextField(help_text='Detailed description of the complaint')),
                ('desired_outcome', models.TextField(blank=True, help_text='What outcome does the complainant want?')),
                ('status', models.CharField(choices=[('RECEIVED', 'Received'), ('ACKNOWLEDGED', 'Acknowledged'), ('INVESTIGATING', 'Under Investigation'), ('AWAITING_RESPONSE', 'Awaiting Response'), ('RESOLVED', 'Resolved'), ('ESCALATED', 'Escalated'), ('CLOSED', 'Closed')], default='RECEIVED', max_length=30)),
                ('date_acknowledged', models.DateField(blank=True, help_text='Date acknowledgement sent (should be within 3 working days)', null=True)),
                ('target_resolution_date', models.DateField(blank=True, help_text='Target date for resolution (typically 20 working days)', null=True)),
                ('actual_resolution_date', models.DateField(blank=True, help_text='Actual date complaint was resolved', null=True)),
                ('investigation_notes', models.TextField(blank=True, help_text='Investigation findings and actions taken')),
                ('root_cause', models.TextField(blank=True, help_text='Root cause analysis of the complaint')),
                ('lessons_learned', models.TextField(blank=True, help_text='Lessons learned and improvements made')),
                ('resolution_details', models.TextField(blank=True, help_text='How the complaint was resolved')),
                ('complainant_satisfied', models.BooleanField(blank=True, help_text='Was the complainant satisfied with the resolution?', null=True)),
                ('escalated_to_care_inspectorate', models.BooleanField(default=False, help_text='Was this escalated to Care Inspectorate?')),
                ('escalation_date', models.DateField(blank=True, null=True)),
                ('escalation_reference', models.CharField(blank=True, max_length=50)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('care_home', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='complaints', to='scheduling.carehome')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_complaints', to=settings.AUTH_USER_MODEL)),
                ('investigating_officer', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='investigating_complaints', to=settings.AUTH_USER_MODEL)),
                ('related_incident', models.ForeignKey(blank=True, help_text='Link to related incident report if applicable', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='related_complaints', to='scheduling.incidentreport')),
                ('resident', models.ForeignKey(blank=True, help_text='Resident the complaint relates to', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='complaints', to='scheduling.resident')),
            ],
            options={
                'verbose_name': 'Complaint',
                'verbose_name_plural': 'Complaints',
                'ordering': ['-date_received'],
                'indexes': [models.Index(fields=['care_home', '-date_received'], name='experience__care_ho_2f5f07_idx'), models.Index(fields=['status', '-date_received'], name='experience__status_f761a3_idx'), models.Index(fields=['severity', '-date_received'], name='experience__severit_58d247_idx'), models.Index(fields=['-date_received'], name='experience__date_re_9d2d4f_idx')],
            },
        ),
    ]
