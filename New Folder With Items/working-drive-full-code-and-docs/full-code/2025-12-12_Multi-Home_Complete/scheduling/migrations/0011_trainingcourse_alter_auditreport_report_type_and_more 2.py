# Generated by Django 5.2.7 on 2025-11-30 22:42

import django.core.validators
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('scheduling', '0010_compliancerule_compliancecheck_complianceviolation_and_more'),
    ]

    operations = [
        migrations.CreateModel(
            name='TrainingCourse',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200)),
                ('category', models.CharField(choices=[('ESSENTIAL', 'Essential Mandatory Training'), ('PERSON_CENTRED', 'Person-Centred Care'), ('CLINICAL', 'Clinical Skills'), ('SPECIALIST', 'Specialist Training')], max_length=20)),
                ('description', models.TextField(blank=True)),
                ('frequency', models.CharField(choices=[('ANNUAL', 'Annual'), ('2_YEAR', 'Every 2 Years'), ('3_YEAR', 'Every 3 Years'), ('ONCE', 'One-time Only')], max_length=20)),
                ('validity_months', models.IntegerField(help_text='Number of months before renewal required')),
                ('is_mandatory', models.BooleanField(default=False)),
                ('requires_competency_assessment', models.BooleanField(default=False)),
                ('requires_certificate', models.BooleanField(default=True)),
                ('minimum_hours', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('sssc_cpd_eligible', models.BooleanField(default=True)),
                ('sssc_cpd_hours', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'ordering': ['category', 'name'],
            },
        ),
        migrations.AlterField(
            model_name='auditreport',
            name='report_type',
            field=models.CharField(choices=[('DAILY_ACTIVITY', 'Daily Activity Log'), ('WEEKLY_SUMMARY', 'Weekly Summary'), ('MONTHLY_COMPLIANCE', 'Monthly Compliance Report'), ('USER_ACTIVITY', 'User Activity Report'), ('DATA_CHANGES', 'Data Changes Report'), ('COMPLIANCE_VIOLATIONS', 'Compliance Violations Report'), ('SHIFT_AUDIT', 'Shift Audit Report'), ('LEAVE_AUDIT', 'Leave Request Audit'), ('ANNUAL_LEAVE', 'Annual Leave Entitlement Report'), ('CUSTOM', 'Custom Report')], max_length=30),
        ),
        migrations.CreateModel(
            name='IncidentReport',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('reference_number', models.CharField(max_length=50, unique=True)),
                ('incident_date', models.DateField()),
                ('incident_time', models.TimeField()),
                ('reported_date', models.DateField(auto_now_add=True)),
                ('incident_type', models.CharField(choices=[('FALL_UNWITNESSED', 'Fall - Unwitnessed'), ('FALL_WITNESSED', 'Fall - Witnessed'), ('FALL_BED', 'Fall - From Bed'), ('FALL_CHAIR', 'Fall - From Chair'), ('FALL_BATHROOM', 'Fall - In Bathroom'), ('SLIP_TRIP', 'Slip/Trip'), ('PHYSICAL_INJURY', 'Physical Injury (Not Fall)'), ('MED_ERROR_OMISSION', 'Medication Error - Omission'), ('MED_ERROR_WRONG_DOSE', 'Medication Error - Wrong Dose'), ('MED_ERROR_WRONG_MED', 'Medication Error - Wrong Medication'), ('MED_ERROR_WRONG_TIME', 'Medication Error - Wrong Time'), ('MED_ERROR_WRONG_PERSON', 'Medication Error - Wrong Person'), ('CONTROLLED_DRUG', 'Controlled Drug Discrepancy'), ('CHOKING', 'Choking Incident'), ('SEIZURE', 'Seizure'), ('DIABETIC_EMERGENCY', 'Diabetic Emergency'), ('ALLERGIC_REACTION', 'Allergic Reaction'), ('PRESSURE_ULCER', 'Pressure Ulcer'), ('UNEXPLAINED_INJURY', 'Unexplained Bruising/Injury'), ('MEDICAL_EMERGENCY', 'Medical Emergency'), ('HEALTH_DETERIORATION', 'Deterioration in Health'), ('AGGRESSION_STAFF', 'Physical Aggression Toward Staff'), ('AGGRESSION_SERVICE_USER', 'Physical Aggression Toward Service User'), ('VERBAL_AGGRESSION', 'Verbal Aggression'), ('SEXUAL_BEHAVIOUR', 'Sexual Behaviour Concerns'), ('PROPERTY_DAMAGE', 'Property Damage'), ('SELF_HARM', 'Self-Harm'), ('ABSCONDING', 'Absconding/Missing Person'), ('SUSPECTED_PHYSICAL_ABUSE', 'Suspected Physical Abuse'), ('SUSPECTED_PSYCHOLOGICAL_ABUSE', 'Suspected Psychological/Emotional Abuse'), ('SUSPECTED_FINANCIAL_ABUSE', 'Suspected Financial Abuse'), ('SUSPECTED_NEGLECT', 'Suspected Neglect'), ('SUSPECTED_SEXUAL_ABUSE', 'Suspected Sexual Abuse'), ('SUSPECTED_DISCRIMINATORY_ABUSE', 'Suspected Discriminatory Abuse'), ('SUSPECTED_INSTITUTIONAL_ABUSE', 'Suspected Institutional Abuse'), ('SELF_NEGLECT', 'Self-Neglect'), ('ALLEGATION_AGAINST_STAFF', 'Allegation Against Staff Member'), ('FIRE_ALARM', 'Fire Alarm Activation'), ('EQUIPMENT_FAILURE', 'Equipment Failure'), ('BUILDING_ISSUE', 'Building/Facilities Issue'), ('INFECTION_OUTBREAK', 'Infection Control Outbreak'), ('FOOD_SAFETY', 'Food Safety Incident'), ('SECURITY_BREACH', 'Security Breach'), ('VISITOR_INCIDENT', 'Visitor Incident'), ('STAFF_INJURY', 'Staff Injury'), ('NEAR_MISS', 'Near Miss - No Harm')], max_length=50)),
                ('location', models.CharField(max_length=200)),
                ('service_user_name', models.CharField(blank=True, max_length=200)),
                ('service_user_dob', models.DateField(blank=True, null=True)),
                ('description', models.TextField(help_text='Factual, objective description of what happened')),
                ('witnesses', models.TextField(blank=True)),
                ('was_witnessed', models.BooleanField(default=False)),
                ('immediate_actions', models.TextField(blank=True)),
                ('injuries_sustained', models.TextField(blank=True)),
                ('body_map_completed', models.BooleanField(default=False)),
                ('photos_taken', models.BooleanField(default=False)),
                ('gp_contacted', models.BooleanField(default=False)),
                ('ambulance_called', models.BooleanField(default=False)),
                ('hospital_attendance', models.BooleanField(default=False)),
                ('hospital_admission', models.BooleanField(default=False)),
                ('medical_notes', models.TextField(blank=True)),
                ('severity', models.CharField(choices=[('NO_HARM', 'No Harm'), ('LOW_HARM', 'Low Harm - Minor Injury'), ('MODERATE_HARM', 'Moderate Harm - Medical Intervention Required'), ('MAJOR_HARM', 'Major Harm - Hospitalization'), ('DEATH', 'Death')], max_length=20)),
                ('risk_rating', models.CharField(choices=[('LOW', 'Low (Green)'), ('MODERATE', 'Moderate (Amber)'), ('HIGH', 'High (Red)'), ('CRITICAL', 'Critical (Purple)')], max_length=20)),
                ('care_inspectorate_notified', models.BooleanField(default=False)),
                ('care_inspectorate_ref', models.CharField(blank=True, max_length=100)),
                ('police_notified', models.BooleanField(default=False)),
                ('police_crime_ref', models.CharField(blank=True, max_length=100)),
                ('local_authority_notified', models.BooleanField(default=False)),
                ('safeguarding_alert_raised', models.BooleanField(default=False)),
                ('investigation_required', models.BooleanField(default=False)),
                ('investigation_due_date', models.DateField(blank=True, null=True)),
                ('investigation_complete', models.BooleanField(default=False)),
                ('investigation_findings', models.TextField(blank=True)),
                ('lessons_learned', models.TextField(blank=True)),
                ('preventive_actions', models.TextField(blank=True)),
                ('incident_closed', models.BooleanField(default=False)),
                ('closed_date', models.DateField(blank=True, null=True)),
                ('manager_reviewed', models.BooleanField(default=False)),
                ('manager_review_date', models.DateField(blank=True, null=True)),
                ('manager_comments', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('closed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='incidents_closed', to=settings.AUTH_USER_MODEL)),
                ('investigation_assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='investigations_assigned', to=settings.AUTH_USER_MODEL)),
                ('manager', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='incidents_reviewed', to=settings.AUTH_USER_MODEL)),
                ('reported_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='incidents_reported', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-incident_date', '-incident_time'],
            },
        ),
        migrations.CreateModel(
            name='InductionProgress',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('start_date', models.DateField()),
                ('expected_completion_date', models.DateField()),
                ('actual_completion_date', models.DateField(blank=True, null=True)),
                ('week1_orientation_complete', models.BooleanField(default=False)),
                ('week1_fire_safety_complete', models.BooleanField(default=False)),
                ('week1_infection_control_complete', models.BooleanField(default=False)),
                ('week1_moving_handling_complete', models.BooleanField(default=False)),
                ('week1_health_safety_complete', models.BooleanField(default=False)),
                ('week2_4_safeguarding_complete', models.BooleanField(default=False)),
                ('week2_4_person_centred_care_complete', models.BooleanField(default=False)),
                ('week5_8_medication_complete', models.BooleanField(default=False)),
                ('week5_8_clinical_skills_complete', models.BooleanField(default=False)),
                ('week9_12_sssc_registration_complete', models.BooleanField(default=False)),
                ('week9_12_quality_improvement_complete', models.BooleanField(default=False)),
                ('week9_12_supervision_support_complete', models.BooleanField(default=False)),
                ('personal_care_hours', models.DecimalField(decimal_places=1, default=0, help_text='Target: 20 hours', max_digits=5)),
                ('meal_prep_hours', models.DecimalField(decimal_places=1, default=0, help_text='Target: 10 hours', max_digits=5)),
                ('documentation_hours', models.DecimalField(decimal_places=1, default=0, help_text='Target: 10 hours', max_digits=5)),
                ('medication_hours', models.DecimalField(decimal_places=1, default=0, help_text='Target: 10 hours (if applicable)', max_digits=5)),
                ('final_assessment_complete', models.BooleanField(default=False)),
                ('final_assessment_date', models.DateField(blank=True, null=True)),
                ('final_assessment_outcome', models.CharField(blank=True, choices=[('COMPETENT', 'Competent'), ('NOT_YET_COMPETENT', 'Not Yet Competent'), ('EXTENDED', 'Induction Extended')], max_length=20)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assessor', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='induction_assessments', to=settings.AUTH_USER_MODEL)),
                ('staff_member', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='induction_progress', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name_plural': 'Induction Progress Records',
            },
        ),
        migrations.CreateModel(
            name='SupervisionRecord',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('session_date', models.DateField()),
                ('session_type', models.CharField(choices=[('PROBATIONARY', 'Probationary (Monthly)'), ('REGULAR', 'Regular (Monthly/6-weekly)'), ('AD_HOC', 'Ad-hoc'), ('RETURN_TO_WORK', 'Return to Work')], max_length=20)),
                ('duration_minutes', models.IntegerField()),
                ('wellbeing_score', models.IntegerField(help_text='1-10 scale', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(10)])),
                ('sickness_days_since_last', models.IntegerField(default=0)),
                ('wellbeing_concerns', models.TextField(blank=True)),
                ('support_offered', models.TextField(blank=True)),
                ('performance_strengths', models.TextField(blank=True)),
                ('performance_development', models.TextField(blank=True)),
                ('mandatory_training_current', models.BooleanField(default=True)),
                ('training_needs_identified', models.TextField(blank=True)),
                ('sssc_registration_current', models.BooleanField(default=True)),
                ('sssc_cpd_hours_to_date', models.DecimalField(decimal_places=1, default=0, max_digits=5)),
                ('safeguarding_concerns_discussed', models.BooleanField(default=False)),
                ('safeguarding_notes', models.TextField(blank=True)),
                ('incidents_since_last', models.IntegerField(default=0)),
                ('incident_learning', models.TextField(blank=True)),
                ('workload_manageable', models.BooleanField(default=True)),
                ('workload_notes', models.TextField(blank=True)),
                ('actions_from_previous', models.TextField(blank=True)),
                ('new_actions', models.TextField(blank=True)),
                ('is_probationary_review', models.BooleanField(default=False)),
                ('probation_progress', models.CharField(blank=True, choices=[('EXCEEDING', 'Exceeding Expectations'), ('MEETING', 'Meeting Expectations'), ('SOME_CONCERNS', 'Some Concerns'), ('SERIOUS_CONCERNS', 'Serious Concerns')], max_length=30)),
                ('probation_recommendation', models.CharField(blank=True, choices=[('CONTINUE', 'Continue Probation'), ('EXTEND', 'Extend Probation'), ('CONFIRM', 'Confirm Permanent Employment')], max_length=30)),
                ('next_supervision_date', models.DateField(blank=True, null=True)),
                ('staff_signature_date', models.DateField(blank=True, null=True)),
                ('supervisor_signature_date', models.DateField(blank=True, null=True)),
                ('staff_comments', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('staff_member', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='supervision_sessions', to=settings.AUTH_USER_MODEL)),
                ('supervisor', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='supervisions_conducted', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-session_date'],
            },
        ),
        migrations.CreateModel(
            name='TrainingRecord',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('completion_date', models.DateField()),
                ('expiry_date', models.DateField()),
                ('trainer_name', models.CharField(blank=True, max_length=200)),
                ('training_provider', models.CharField(blank=True, max_length=200)),
                ('certificate_number', models.CharField(blank=True, max_length=100)),
                ('certificate_file', models.FileField(blank=True, null=True, upload_to='training_certificates/')),
                ('competency_assessed', models.BooleanField(default=False)),
                ('competency_date', models.DateField(blank=True, null=True)),
                ('competency_outcome', models.CharField(blank=True, choices=[('COMPETENT', 'Competent'), ('NOT_YET_COMPETENT', 'Not Yet Competent')], max_length=20)),
                ('sssc_cpd_hours_claimed', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('competency_assessor', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='competency_assessments_conducted', to=settings.AUTH_USER_MODEL)),
                ('course', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='scheduling.trainingcourse')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='training_records_created', to=settings.AUTH_USER_MODEL)),
                ('staff_member', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='training_records', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-completion_date'],
                'unique_together': {('staff_member', 'course', 'completion_date')},
            },
        ),
    ]
